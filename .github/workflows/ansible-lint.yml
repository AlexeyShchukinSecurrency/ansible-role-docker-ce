name: Ansible Lint # feel free to pick your own name
on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Set Ansible List deps from file
        run: |
          ANSIBLE_LINT_DEPS_OVERRIDES=$(cat ${GITHUB_WORKSPACE}/.github/actions-config/ansible-lint/requirements.txt)
          # Removes newlines and convert into spaces
          ANSIBLE_LINT_DEPS_OVERRIDES=$(echo $ANSIBLE_LINT_DEPS_OVERRIDES)
          echo "::set-env name=ANSIBLE_LINT_DEPS_OVERRIDES::$ANSIBLE_LINT_DEPS_OVERRIDES"

      - name: Print env
        run: env

      - name: Lint Ansible role
        uses: ansible/ansible-lint-action@master
        with:
          targets: ""
          override-deps: "${ANSIBLE_LINT_DEPS_OVERRIDES}"
          # |
          #   ansible==2.9
          #   ansible-lint==4.2.0
          args: ""
